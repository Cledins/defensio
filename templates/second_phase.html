<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='style2.css') }}">
    <title>Phase 2</title>
</head>
<body>

    
    <body class="bg-gray-200">
        <div id="flex-container-1" class="flex-container">
                <!-- Logo en haut à gauche -->
                <img src="/static/logo.png" alt="Votre Logo" class="w-12 h-12">
                <!-- Timer -->
                <div id="timer">Timer : <span id="countdown"></span></div>
                <!-- Numéro du groupe en haut à droite -->
                <div id="numberDisplay" class="text-xl font-bold"></div>
           
        </div>
    </div>
    
    <div id="flex-container-2" class="flex-container">
        <!-- Jauges -->    
        <div>
            <img src="/static/C.png" alt="Jauge C">
            <div id="JaugeC"></div>
        </div>
        <div>
            <img src="/static/R.png" alt="Jauge R">
            <div id="JaugeR"></div>
        </div>
        <div>
            <img src="/static/I.png" alt="Jauge I">
            <div id="JaugeI"></div>
        </div>
    </div>
    
    <div id="flex-container-3" class="flex-container">
        <div id ="flex-container-4" class="flex-container">
            <div id="dialog-container" class="flex-container">
                <label for="exchanges">Nombre d'échanges : </label>
                <input type="number" id="exchanges" min="0">
        
                <label for="donations">Donations : </label>
                <input type="number" id="donations" min="0">
        
                <label for="received">Reçus : </label>
                <input type="number" id="received" min="0">
        
                <button onclick="submitInputs()">Soumettre</button>
            </div>
    
        </div>
        <div class="additional-containers">
            <!-- Additional flex containers (4 in this example) -->
            <div class="additional-container">Défense feu</div>
            <div class="additional-container">Défense terre</div>
            <div class="additional-container">Défense air</div>
            <div class="additional-container">Défense eau</div>
        </div>
    </div>

    

        <!-- Floating message container -->
    <div id="floating-message" class="floating-message">
        <p>Le dragon éternue, créant une vague de flammes traversant l'empire.</p>
        <button onclick="confirmMessage()">Confirm</button>
    </div>

    


    <script>
        // Set the duration of the timer in seconds
        const timerDuration = 500; // Change this value to the desired duration
    
        let countdown = timerDuration;
        let countdownInterval;
    
        function startTimer() {
        countdownInterval = setInterval(updateTimer, 1000);
        }
    
        function updateTimer() {
        const timerElement = document.getElementById('countdown');
    
        if (countdown > 0) {
            countdown--;
            timerElement.textContent = countdown;
        } else {
            clearInterval(countdownInterval);
            // Rajouter deuxième cataclysme 
        }
        }
    
        startTimer();

        
    </script>
    
    <script>
    function getCookie(name) {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = cookies[i].trim();
            if (cookie.indexOf(name + "=") === 0) {
            return cookie.substring(name.length + 1);
            }
        }
        return "";
        };

    var storedNumber = getCookie("number");

    function updateUI() {
        // Update gauge values
        document.getElementById('JaugeR').innerText = `Diplomatie : ${R}`;
        document.getElementById('JaugeI').innerText = `Popularité : ${I}`;
        document.getElementById('JaugeC').innerText = `Ressources : ${C}`;

        // Update defense values
        const defenseFeu = parseInt(fireDefense);
        const defenseTerre = parseInt(earthDefense);
        const defenseAir = parseInt(airDefense);
        const defenseEau = parseInt(waterDefense);

        document.getElementsByClassName('additional-container')[0].innerText = `Défense feu: ${parseInt(defenseFeu)}`;
        document.getElementsByClassName('additional-container')[1].innerText = `Défense terre: ${parseInt(defenseTerre)}`;
        document.getElementsByClassName('additional-container')[2].innerText = `Défense air: ${parseInt(defenseAir)}`;
        document.getElementsByClassName('additional-container')[3].innerText = `Défense eau: ${parseInt(defenseEau)}`;
    }

    fetch('/get-jauge/'+storedNumber)
        .then(response => response.json())
        .then(apidata => {
            R=apidata.jauge_r;
            I=apidata.jauge_i;
            C=apidata.jauge_c;
            D=apidata.jauge_d;
            airDefense=apidata.air_defense;
            waterDefense=apidata.water_defense;
            fireDefense=apidata.fire_defense;
            earthDefense=apidata.earth_defense;

            updateUI();
        });
 
    </script>

<!-- <script>
     function submitInputs() {
        // Get values from input elements
        const exchangesValue = parseInt(document.getElementById('exchanges').value) || 0;
        const donationsValue = parseInt(document.getElementById('donations').value) || 0;
        const receivedValue = parseInt(document.getElementById('received').value) || 0;

        // Update metrics based on input values
        updateMetricsForInputs(exchangesValue, donationsValue, receivedValue);

        // You can send the values to the server using fetch or update the UI accordingly
    }

    function updateMetricsForInputs(exchanges, donations, received) {
        // Update metrics based on input values
        R += 5 * exchanges;
        C += 5 * received;
        I += 10 * donations;
        C -= 10 * donations;
        I -= 2 * received;

        // Update UI elements
        updateUI();
    }

</script> -->

<script>
    // Function to confirm the message and decrease fire_defense by 5
    function confirmMessage() {
        // Decrease fire_defense by 5 (adjust the variable names based on your code)
        defenseFeu -= 5;

        // Hide the floating message
        document.getElementById('floating-message').style.display = 'none';
    }

    // Show the floating message when the page loads
    document.addEventListener('DOMContentLoaded', function () {
        document.getElementById('floating-message').style.display = 'block';
    });
</script>

</body>
</html>
